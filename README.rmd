---
output:
  md_document:
    variant: markdown_github
---

#Question 1 Solution 

#explanations of how i made the functions around in my each individual function in the given code folder

```{r setup, include=FALSE}

library(glue)
library(tidyverse)
library(stringr)
library(dplyr)
library(ggplot2)

# Source in all your functions:
list.files('Question_1/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))

source("code/filter_and_arrange_baby_names.R")
source("code/prepare_HBO_data.R")
source("code/combine_top_25_names.R")
source("code/plot_total_baby_names_per_year_by_gender.R")
source("code/plot_top_25_name_proportions.R")
source("code/plot_name_persistence_heatmap.R")
source("code/calculate_correlation.R")
source("code/plot_correlation.R")
source("code/plot_HBO_name_persistence_summary.R")
source("code/plot_name_persistence_summary.R")

#Loading the Data 
Baby_Names <- readRDS("data/US_Baby_names/Baby_Names_By_US_State.rds")
charts <- readRDS("Data/US_Baby_names/charts.rds")
HBO_Titles <- readRDS("Data/US_Baby_names/HBO_titles.rds")
HBO_Credits <- readRDS("Data/US_Baby_names/HBO_credits.rds")

#Creating Different Datasets for Later Use
Baby_Names_df<- filter_and_arrange_baby_names(Baby_Names)
HBO_joined_df <- prepare_HBO_data(HBO_Titles, HBO_Credits)
combined_result_final_top_25_names <- combine_top_25_names(Baby_Names_df, HBO_joined_df, "Count", "tmdb_popularity")

Girl_Baby_Names_df <- Baby_Names_df %>% filter(Gender == "F")
Boy_Baby_Names_df <- Baby_Names_df %>% filter(Gender == "M")


```

# Analaysing the Persistence and Patterns of Baby Naming Conventions (Plot 1)

Plot Analysis: # Analaysing the Persistence and Patterns of Baby Naming Conventions 

The naming trends of children have long been a subject of fascination and study. Recently, a New York-based kids' toy design agency has expressed interest in leveraging data analytics to understand these trends better. The primary goal is to identify the factors that influence baby names, such as popular movie characters, US presidential candidates, celebrities, and top-ranking songs or artists. By comprehending these patterns, the agency aims to predict which character names might resonate best with children, thereby enhancing the appeal of their toys.

To facilitate this analysis, we have been provided with an extensive dataset of baby names in the US, spanning from 1910 to 2014. This dataset includes annual data for all US states, offering a comprehensive view of naming patterns over more than a century. Additionally, we have access to population data by state and city, which will help us generate proportional insights at the state level. To supplement our primary dataset, we have also compiled data on music, movies, and TV series, including the Top 100 Billboard songs since 1958 and HBO movie and series titles with their audience popularity scores.

One of the key aspects of our analysis involves examining the longevity and persistence of baby names. Specifically, we aim to determine whether popular names tend to persist over time or if they fade away as fleeting trends. A useful method for this investigation is the Spearman rank correlation, which will help us assess the rank similarity of the top 25 most popular boys' and girls' names from one year to the next three years. This will provide insights into whether the trends of popular names have become more or less persistent over the decades, particularly since the 1990s.

Analysing the plot: Figure \ref{Figure1} below shows the total count of baby names per year by gender. The blue line represents male names, while the red line represents female names. This visualization highlights the fluctuations in the popularity of baby names over time, offering a foundation for our deeper analysis of naming trends. 

##Plot 1

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Total Count of Baby Names by Gender.\\label{Figure1}", fig.ext = 'png', fig.height = 3, fig.width = 5}

total_baby_names_plot <- plot_total_baby_names_per_year_by_gender(Girl_Baby_Names_df, Boy_Baby_Names_df)
print(total_baby_names_plot )

```

to knit i used the following with every figure, adjusting for the name and figure number "{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Total Count of Baby Names by Gender.\\label{Figure1}", fig.ext = 'png', fig.height = 3, fig.width = 5}" 

##Plot 2: 

Figure \ref{Figure2} below illustrates the proportion of the top 25 baby names over time for both female and male names.The horizontal axis represents the years from 1950 to 2014. The vertical axis represents the proportion of babies given a specific name each year. This is calculated as the count of babies with that name divided by the total count of babies for that year.Each line represents a specific name that was in the top 25 for that year. The color of each line corresponds to a different name. The plot is divided into two facets: one for female names and one for male names. This separation helps to compare the trends for female and male names independently.

+ Female Names: The left facet shows the proportion trends for the top 25 female names over time. The plot indicates that the popularity of the top names was relatively higher in the past (1950s to 1980s) and has become more evenly distributed in recent years.

+ Male Names: The right facet shows the proportion trends for the top 25 male names over time. Similar to female names, the plot indicates that the popularity of the top names was higher in the past and has become more evenly distributed in recent years. 

The peaks in the plot indicate years when specific names were particularly popular. The valleys indicate years when the popularity of those names decreased. Declining Trends: For both female and male names, the plot shows a general declining trend in the proportion values, indicating that the popularity of top names has become less concentrated over time. This suggests a diversification in naming trends, with a wider variety of names being used in recent years.

##Plot 3: 


```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Proportion of the Top 25 Baby Names and their Persistence Over Time\\label{Figure2}", fig.ext = 'png', fig.height = 4, fig.width = 6}

#The vertical axis represents the proportion of babies given a specific name each year. This is calculated as the count of babies with that name divided by the total count of babies for that year.

#This function visualizes the proportion of the top 25 baby names over time for both females and males. This helps to identify trends, patterns, and the persistence of popular baby names over the years.

top_name_proportions_plot<- plot_top_25_name_proportions(Girl_Baby_Names_df, Boy_Baby_Names_df)
top_name_proportions_plot
```


# Analysing the Persistence of Names over Time: A Time Series Analysis

Figure \ref{Figure3} below showcases the persistence of the most popular baby names from a given dataset. The color gradient from white to blue represents the presence of a name in the top 25 baby names for each year, with darker shades of blue indicating higher persistence. Notable names such as "Jessica," "Jennifer," and "Emily" show strong persistence over the years, particularly in the 1980s and 1990s.
Names like "Susan" and "Mary" were more popular in earlier decades, while "Ashley" and "Amanda" gained popularity later on.Names like "Robert," "Michael," and "John" demonstrate strong persistence, especially from the 1960s to the 2000s.
Other names such as "Matthew," "Joshua," and "Joseph" show high presence in the top 25 names in the 1980s and 1990s.
Male names show more consistent presence over a longer period compared to female names, which exhibit more variation and changes over the years.

##Plot 4: 


```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Proportion of the Top 25 Baby Names and their Persistence Over Time for both Genders\\label{Figure3}", fig.ext = 'png', fig.height = 4, fig.width = 6}

plot_baby_name_persistance<- plot_name_persistence_heatmap(Girl_Baby_Names_df, Boy_Baby_Names_df)
plot_baby_name_persistance

```

# Analyzing how long each name stayed in top 25 

##Plot 5: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Number of Years the Top 25 Baby Names Persisted Over Time for both Genders\\label{Figure4}", fig.ext = 'png', fig.height = 4, fig.width = 6}

summary_name_persistance_plot<- plot_name_persistence_summary(Girl_Baby_Names_df, Boy_Baby_Names_df)
summary_name_persistance_plot

```

We can therefore see that the top boy names over the last few decades illustrate significant persistence in comparison to that of girl names, therefore, we will further analyse factors influencing girl names as they display significantly higher variability which could be linked to alternate factors.  

# Analysing the HBO Dataset

##Plot 6: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Persistence of HBO names in the top rankings over time\\label{Figure5}", fig.ext = 'png', fig.height = 4, fig.width = 6}

HBO_name_persistence_plot <- plot_HBO_name_persistence(combined_result_final_top_25_names)
HBO_name_persistence_plot

```

We can see the above persistence is all male names within data regarding movies on HBO over the last few decades. 

# The Persistence of HBO names in the Top Rankings over Time.

In the Figure \ref{Figure6} below, the name "John" stands out as the most persistent name, having stayed in the top rankings for 40 years. This indicates that "John" was a popular name in HBO shows over a prolonged period. Names like "Robert," "Michael," "David," and "Richard" also exhibit high persistence, each maintaining their presence in the top rankings for over 20 years.The presence of these names over many years suggests a trend in character naming conventions in HBO shows. The recurrence of these names might reflect cultural preferences or character archetypes frequently used in HBO's storytelling.

The distribution of the years in top rankings shows that while some names had a very long presence, there is a gradual decline as we move down the list. Names like "Tom," "Peter," and "Jack," though still significant, have a lesser persistence compared to the top names.

The bar chart effectively highlights the relative persistence of each name, with the length of the bars corresponding to the number of years each name stayed in the top rankings. The use of horizontal bars makes it easy to compare the persistence across different names. This analysis helps in understanding the longevity and popularity of certain names within HBO shows, providing insights into naming trends and cultural influences over the years.

##Plot 7: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Persistence of HBO names in the top rankings over time.\\label{Figure6}", fig.ext = 'png', fig.height = 4, fig.width = 6}

# Plot the persistence of HBO names
summary_HBO_persistance_plot<- plot_HBO_name_persistence_summary(combined_result_final_top_25_names)
summary_HBO_persistance_plot

```

Now i will analyse the correlation between the persistent boy names within the Baby names dataframe in comparison to that of the most persistent names within the HBO baby frame, which all happen to be male. 

##Plot 8: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Correlation Between the Persistence of HBO names and Baby Names.\\label{Figure7}", fig.ext = 'png', fig.height = 4, fig.width = 6}

#This calls the calculate_correlation function, passing in the dataset combined_result_final_top_25_names.The purpose of this function is to calculate the persistence of names in both the baby names and HBO datasets, and then compute the Spearman correlation between these two persistence values.
result <- calculate_correlation(combined_result_final_top_25_names)

#Now i am extracting the combined_persistence data from the result of the calculate_correlation function.Combined_persistence contains the combined persistence data for both baby names and HBO names, which is necessary for further analysis and plotting.
combined_persistence <- result$combined_persistence

#This then extracts the correlation_value from the result of the calculate_correlation function. The correlation_value is the computed Spearman correlation between the persistence of baby names and HBO names. It quantifies the strength and direction of the association between the two datasets.

correlation_value <- result$correlation_value

#Finally the plot_correlation function is called, passing in the combined_persistence data and the correlation_value.The plot_correlation function generates a plot that visualizes the relationship between the persistence of baby names and HBO names, and it includes a regression line to illustrate the trend. This helps in visually interpreting the correlation.

correlation_plot <- plot_correlation(combined_persistence, correlation_value)

print(correlation_plot)
print(paste("Spearman correlation value: ", round(correlation_value, 2)))

```

In Figure \ref{Figure7} above the correlation between the persistence of baby names in the top 25 rankings and HBO names in the top 25 rankings over time are analysed. Each point on the scatter plot represents a name that appears in each of the datasets. The x-axis shows the number of years a name remained in the top 25 baby names, while the y-axis indicates the number of years the same name stayed in the top 25 HBO rankings.

A positive Spearman correlation value of `r round(correlation_value, 3)`. was calculated, which indicates a moderate positive correlation between the persistence of baby names and HBO names. This suggests that names that tend to be popular for longer periods as baby names are also likely to remain popular in HBO rankings for a significant duration. The blue line represents a linear fit, illustrating the trend of this correlation. While there is some spread in the data, with a number of outliers, the general trend suggests that there is a relationship between the duration of name popularity in both contexts.

##Question 2 Solution

```{r setup, include=FALSE}

# Load necessary libraries
library(ggplot2)
library(dplyr)
library(RColorBrewer)
library(tidyverse)

list.files('Question_2/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))

#Loading the Data
coldplay <- read_csv("Data/Coldplay_vs_Metallica/Coldplay.csv")
metallica <- read_csv("Data/Coldplay_vs_Metallica/metallica.csv")
spotify <- readRDS("Data/Coldplay_vs_Metallica/Broader_Spotify_Info.rds")
billboard_100 <- readRDS("Data/Coldplay_vs_Metallica/charts.rds")

#Filtering the data so only studio produced songs are present
coldplay_filtered <- filter_coldplay_data(coldplay)

metallica_filtered <- filter_metallica_data(metallica)

# Combine the datasets for comparison
combined_band_data <- bind_rows(coldplay_filtered, metallica_filtered)

```

# An Analysis of the Music Industry \label{An Analysis of the Music Industry}

Coldplay and Metallica are two iconic bands that have left an indelible mark on the music industry. Coldplay, known for its atmospheric soundscapes and introspective lyrics, has captivated audiences worldwide since its debut in the early 2000s. In contrast, Metallica's powerful riffs and intense performances have made them a staple in the heavy metal genre since the 1980s. This project aims to compare the performance of these two bands using data from the Billboard Top 100 and Spotify, providing insights into their popularity and influence over time.

The analysis focuses on several key variables within the datasets. From the Billboard Top 100, we examine metrics such as the number of songs each band has placed in the Top 100, the peak rank achieved by these songs, and the total number of weeks they have remained on the chart. These metrics offer a comprehensive view of each band's commercial success and longevity in the music charts. On Spotify, we analyze the number of streams and popularity scores of their songs, providing a modern perspective on their relevance in the current digital music landscape. By comparing these variables, we can gain a deeper understanding of how Coldplay and Metallica have evolved over time and how their music continues to resonate with audiences today.


# Comparisons of the Bands Popularity\label{Comparisons of the Bands Popularity}


Coldplay and Metallica, though distinct in their musical styles, both enjoy significant popularity across their albums. Popularity in the figures below measure the popularity of the albums ranging form 0 to 100. The Data source from which this was taken is from spotify

##Plot 1: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Coldplay's Popularity per Album.\\label{Figure1}", fig.ext = 'png', fig.height = 5, fig.width = 7}

boxplot_popularity_coldplay<- popularity_boxplot(coldplay_filtered, xaxis_size = 10, xaxis_rows = 3)

boxplot_popularity_coldplay

```
##Plot 2: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Metallica's Popularity per Album.\\label{Figure2}", fig.ext = 'png', fig.height = 5, fig.width = 7}

popularity_boxplot_metallica<- popularity_boxplot(metallica_filtered, xaxis_size = 10, xaxis_rows = 3)

popularity_boxplot_metallica
```
As you can see from \ref{Figure1} and \ref{Figure2}, Coldplay and Metallica, despite having very different musical styles, both enjoy massive popularity across their albums. However as seen in \ref{Figure3} below, Coldplay is more popular overall than Metallica. 

##Plot 3: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Comparing both Band's Popularity\\label{Figure3}", fig.ext = 'png', fig.height = 5, fig.width = 7}

both_band_boxplot<- create_box_plot(combined_band_data, "popularity", "Popularity Comparison: Coldplay vs Metallica")
both_band_boxplot

```

# Density Plot of Popularity:

The density plot reveals the distribution of song popularity for Coldplay and Metallica. Coldplay's songs tend to have a more uniform distribution with a slight peak, indicating a consistent level of popularity across their catalog. Metallica, on the other hand, shows a more pronounced peak, suggesting that a significant number of their songs reach higher popularity scores. This contrast highlights how Metallica has a core set of extremely popular tracks, while Coldplay's popularity is more evenly spread across their discography. This plot helps us understand the different ways in which each band's music resonates with their listeners.

##Plot 4: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Density Plot of Popularity\\label{Figure4}", fig.ext = 'png', fig.height = 5, fig.width = 7}

#This function is designed to create a density plot that visualizes the distribution of a specified metric for Coldplay and Metallica. This helps to compare how the values of the given metric (e.g., popularity, energy, danceability) are distributed for each band.

density_plot_bands <- combined_density_plot(combined_band_data, "popularity", "Density Plot of Popularity: Coldplay vs Metallica")
density_plot_bands

```
# Scatter Plot of Energy vs Danceability:

The scatter plot of energy versus danceability, \ref{Figure5}, offers an insightful comparison between Coldplay and Metallica's musical styles. Coldplay's songs generally cluster towards the higher end of danceability, reflecting their melodic and rhythmic compositions designed to be both catchy and uplifting. In contrast, Metallica's tracks tend to score higher on energy but lower on danceability, showcasing their intense sound that's characteristic of heavy metal. This scatter plot effectively illustrates the distinct musical signatures of each band, highlighting Coldplay's tendency towards more danceable tunes and Metallica's focus on high-energy, powerful performances.

##Plot 5: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Energy versus Danceability\\label{Figure5}", fig.ext = 'png', fig.height = 5, fig.width = 7}

#This function is designed to create a scatter plot that visualizes the relationship between two specified metrics for Coldplay and Metallica. This helps compare how these metrics (e.g., like I did here energy and danceability) correlate for each band.

scatterplot_danceability_energy <- combined_scatter_plot(combined_band_data, "energy", "danceability", "Energy vs Danceability: Coldplay vs Metallica")
scatterplot_danceability_energy

```
# Analysing the Billboard Top 100

Coldplay and Metallica have both spent a lot of time on the Billboard Top 100, showing their lasting popularity. Coldplay's songs, with their emotional and melodic style, have kept them on the charts for many weeks. Metallica's powerful and energetic tracks have also secured them a strong presence, especially in the rock and metal genres. The bar plot below clearly shows that while both bands have had substantial success, their chart performance underscores their ability to engage listeners and sustain their popularity over extended periods. This analysis provides a compelling visual representation of the lasting impact both bands have had on the music industry.

##Plot 6: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Billboard 100s Results for both bands\\label{Figure6}", fig.ext = 'png', fig.height = 5, fig.width = 7}

# Filter the Billboard dataset for Coldplay and Metallica
billboard_filtered_data <- filter_billboard_for_bands(billboard_100)

#This function is designed to create a bar plot that visualizes the total number of weeks Coldplay and Metallica have spent on the Billboard Top 100. This helps compare the overall chart presence of each band.

billboard_boxplot <- bar_plot_billboard_weeks(billboard_filtered_data)
billboard_boxplot

```
# Conclusion

In conclusion, Coldplay and Metallica have demonstrated remarkable longevity and musical progression over the years. Coldplay's ability to evolve their sound while maintaining their signature emotional and melodic style has kept them relevant and popular. Similarly, Metallica's consistent delivery of powerful, energetic music has solidified their place in the heavy metal genre. Both bands have shown that they can adapt and thrive in the ever-changing music industry, securing a lasting legacy through their continuous presence on the charts and streaming platforms.


##Question 3 Solution 

```{r setup, echo = FALSE, include=FALSE}

# Load necessary libraries
library(tidyverse)
library(knitr)
library(kableExtra)
library(dplyr)
library(xtable)
library(ggplot2)

#Loading the Data

alloc <- read_csv("data/Ukraine_Aid/Financial_Allocations.csv")
commit <- read_csv("data/Ukraine_Aid/Financial_Commitments.csv")

list.files('Question_3/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))

# Summarize the data while filtering for only EU countries

source("code/summarise_commitments.R")
source("code/summarise_allocations.R")
source("code/top_contributors.R")
source("code/top_eu_committers.R")
source("code/build_commit_table.R")
source("code/build_allocations_table.R")
source("code/plot_top_humanitarian_allocators.R")
source("code/plot_top_humanitarian_committers.R")
source("code/lowest_contributors.R")
source("code/bottom_eu_committers.R")

alloc_summary <- summarise_allocations(alloc)
commit_summary <- summarise_commitments(commit)

# Combine summaries and find total for the EU Commissions and Council
combined_summary <- left_join(alloc_summary, commit_summary, by = "Country")
```

# Introduction 

- **Background of the Russia-Ukraine Conflict**
  - The conflict between Russia and Ukraine escalated in 2014 with Russia's annexation of Crimea and support for separatist movements in Eastern Ukraine.
  
  - The conflict has led to significant humanitarian crises and geopolitical tensions, impacting international relations and security dynamics.

- **European Union's Response**
  - The EU has played a crucial role in providing support to Ukraine, both through individual member states and collective efforts.
  - Financial aid and commitments have been made to support Ukraine's military, humanitarian, and economic needs.

- **Purpose of the Analysis**
  - This analysis aims to evaluate the extent of aid provided by EU countries to Ukraine.
  - The focus is on financial allocations and commitments, with a breakdown into different types of aid such as military and humanitarian support.

- **Key Questions Addressed**
  - Which EU countries are the top contributors in terms of financial allocations and commitments to Ukraine and which are the lowest?
  - How do the types of aid (military vs. humanitarian) vary among the top contributing countries?
  
- **Significance of the Analysis**
  - Understanding the support provided by EU countries helps gauge the international community's efforts in assisting Ukraine.
  - The analysis sheds light on the strategic and humanitarian priorities of the EU in addressing the ongoing conflict and its repercussions.

# The Difference between Financial Allocations and Financial Commitments

+ Financial Allocation refers to the funds that have been officially designated or set aside for a specific purpose or  project. In this case, it means the money that has been allocated by EU countries to support Ukraine.An EU country might allocate €1 billion for humanitarian aid to Ukraine, which means this amount is reserved in their budget for this purpose. 
+ Financial Commitment refers to the amounts that have been pledged or promised to be delivered in support of Ukraine. These are the funds that countries have committed to providing, which might be part of international agreements or announcements. An EU country might commit €500 million to Ukraine over the next two years for military aid, which means they promise to provide this amount, but it might be delivered in installments. 

+ Financial Allocations are usually immediate and part of a current budget. These funds have been set aside and are ready for disbursement.
Financial Commitments may span over multiple years and indicate future support. These are pledges made to provide aid over a longer period and may require further authorization or legislative approval before they can be fully disbursed.

+ Financial Allocations have an immediate impact as they are part of active budgets and can be disbursed quickly.
Financial Commitments impact planning and international relations, signaling long-term support. They indicate a commitment to future aid, which can influence diplomatic and strategic planning.

# The Top 5 European Union Allocators of Aid to the Ukraine

- **EU (Commission and Council)**:
  - Stands out as the largest contributor, with a total allocation of \$43.83 billion.
  - Includes significant military support totaling \$34.38 billion.
  - Notable humanitarian allocation of \$10.49 billion.
- **Estonia**:
  - Second-largest contributor with \$29.66 billion.
  - Primarily focused on humanitarian aid, highlighting its significant commitment to supporting Ukraine.
- **Other Notable Contributors**:
  - Italy, Bulgaria, France, and Finland have also contributed various amounts.
  - France provides the highest military allocation among them at \$10.75 billion.
- **Total Bilateral Allocation**:
  - Aggregates these contributions, demonstrating the comprehensive financial support provided directly by each country.
- **Overall Illustration**:
  - This table underscores the critical role played by individual EU countries in aiding Ukraine.
  - Highlights both military and humanitarian efforts.
  
##Table 1: 

```{r, top-contributors-allocations, echo=FALSE, fig.align='center', results = 'asis'}

#This function is designed to identify and return the top contributing EU countries based on their total financial allocations. This helps in comparing the extent of financial aid provided by different countries.

top_eu_contributors <- top_contributors(alloc_summary, top_n = 6)

top_contributors_table <- build_allocations_table(top_eu_contributors, Latex = TRUE)

```

Table 2.1 above presents a detailed summary of the financial allocations made by EU countries to Ukraine, with the first column a reference to the total amount allocated by the EU. 

##Plot 1: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Top 10 EU Countries Humanitarian Allocations to Ukraine\\label{Figure1}", fig.ext = 'png', fig.height = 5, fig.width = 7}

# This function is designed to create a bar plot that visualizes the top 10 EU countries in terms of humanitarian aid allocations. This helps compare the extent of humanitarian aid provided by different countries.

top_humanitarian_allocators_eu <- plot_top_humanitarian_allocators(alloc_summary, top_n = 10)
top_humanitarian_allocators_eu  

```
# The Top 5 European Countries in terms of Financial Commitment 

- **EU (Commission and Council)**:
  - Leads with a total commitment of \$71.04 billion.
  - Indicates long-term financial support with a significant military commitment of \$56.11 billion.
  
- **Germany**:
  - Second-largest contributor with a commitment of \$24.71 billion.
  - Includes \$19.94 billion for military aid, reflecting its strategic support for Ukraine's defense capabilities.
  
- **Other Notable Commitments**:
  - The Netherlands, Poland, France, and Austria also make notable commitments.
  - Military commitments form a substantial part of their total contributions.
  
- **Overall Illustration**:
  - This table illustrates the pledged support from various EU countries.
  - Showcases their readiness to provide ongoing financial and military assistance to Ukraine.
  - Reflects the strategic and humanitarian priorities of the EU countries in supporting Ukraine amidst ongoing challenges.
  
##Table 2:   

```{r, top-commiters, echo=FALSE, fig.align='center', results = 'asis'}

#This function is designed to identify and return the top contributing EU countries based on their total financial commitments. This helps in comparing the extent of financial aid provided by different countries.

top_committers <- top_eu_committers(commit_summary, top_n = 6)

top_committers_table <- build_commit_table(top_committers, Latex = TRUE)

```
Table 3.1 above summarizes the financial commitments made by EU countries to Ukraine, emphasizing their pledged support.

##Plot 2: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Top 10 EU Countries Humanitarian Commitments to Ukraine\\label{Figure2}", fig.ext = 'png', fig.height = 5, fig.width = 7}

# # This function is designed to create a bar plot that visualizes the top 10 EU countries in terms of humanitarian aid commitments. 

plot_top_humanitarian_commit <- plot_top_humanitarian_committers(commit_summary, top_n = 10)
plot_top_humanitarian_commit 

```
# Lowest 5 European Countries in terms of Financial Allocations

##Table 3:

```{r, lowest-allocators, echo=FALSE, fig.align='center', results = 'asis'}

 #now these functions find those who contributed the least into allocations

lowest_contributions<- lowest_contributors(alloc_summary)

lowest_allocations_table <- build_allocations_table(lowest_contributions, Latex = TRUE)

```

# Lowest 5 European Countries to Financially Commit

##Table 4:

```{r, lowest-commiters, echo=FALSE, fig.align='center', results = 'asis'}

# Get the bottom 5 committers
bottom_eu_committment<- bottom_eu_committers(commit_summary, bottom_n = 5)

# Create the table for the bottom 5 committers
bottom_committers_table <- build_commit_table(bottom_eu_committment, Latex = TRUE)

```
- **General Observations**:
  - Both tables highlight countries with minimal total financial allocations and commitments.
  - Despite low overall contributions, some countries still provide notable military aid.

- **Lowest Allocators**:
  - These countries have not allocated significant funds to Ukraine in terms of total financial aid.
  - Cyprus and Denmark stand out with higher military allocations compared to others, despite no total allocation.

- **Lowest Committers**:
  - Similar to the allocators, these countries show minimal total commitments.
  - The Czech Republic, although low in total commitment, has a substantial military commitment.
  - Estonia has a notable total bilateral commitment, suggesting focused aid despite a low overall commitment.

- **Implications**:
  - These tables help identify the countries with the least financial engagement in supporting Ukraine.
  - The focus on military aid indicates strategic contributions, even from countries with otherwise low financial involvement.

(in order to get this section with tables to knit, i ensured all the chunk options were correct, all the righ packages were loaded and that my YAML header was appropriate)

##Question 4 Solution 

```{r setup, include=FALSE}

knitr::opts_chunk$set(fig.path = 'README_files/figure-latex/')

# Load necessary libraries

library(dplyr)
library(scales)
library(tidyr)
library(knitr)
library(kableExtra)
library(xtable)
library(ggplot2)
library(broom)

# Source in all your functions:
list.files('Question_4/code/', full.names = T, recursive = T) %>% as.list() %>% walk(~source(.))

#loading the relevant data 
Winter<- readRDS("Data/olympics/winter.rds")
Summer <- readRDS("Data/olympics/summer.rds")
GDP <- readRDS("Data/olympics/GDP.rds")

source("code/filter_process_summer.R")
source("code/filter_process_winter.R")
source("code/summarise_country_medals.R")
source("code/total_metals_table.R")
source("code/filter_process_all_countries.R") 
source("code/find_top_performing_countries.R") 
source("code/filter_and_combine_all_olympic_data.R") 
source("code/filter_and_combine_olympic_data_dominators.R") 
source("code/create_time_series_plot.R") 
source("code/metrics_data.R")
source("code/find_and_visualize_top_countries.R")
source("code/analyze_gender_gold_correlation.R")
source("code/analyze_top_countries_gender_performance.R")
source("code/plot_medal_distribution_by_country.R")
source("code/analyze_archery.R")

filtered_summer_olympics <- filter_process_summer(GDP, Summer)

India_medal_summary <- summarise_country_medals(Summer, "IND") 

#in order to double check our filtering process was successful (yes)
total_metals_India <- sum(India_medal_summary$Medal_Count)

```

# Analysing the Total Metals Won by India and other Countries 

##Table 1:

```{r, total-metals, echo = FALSE, fig.align='center', results = 'asis'}

#The total_metals_table function processes the input data to create a formatted table summarizing the total medals won by countries. 

table_total_metals_india_and_others <- total_metals_table(filtered_summer_olympics)

```

+ The Table \ref{tab:total_medals} above presents a comprehensive analysis of the total medals won by India and other selected countries in the Olympics. China leads the chart with an impressive 430 total medals, comprising 170 gold, 141 silver, and 119 bronze medals, reflecting its dominance in the global sporting arena. Russia follows with 376 total medals, including 125 gold, 113 silver, and 138 bronze medals, showcasing its strong performance in various sports disciplines.

+ Other notable performances include Brazil and South Africa, which have secured 107 and 76 total medals, respectively. Brazil's medal tally is highlighted by 23 gold, 29 silver, and 55 bronze medals, while South Africa has 23 gold, 26 silver, and 27 bronze medals.

+ India, the focal point of this analysis, has won a total of 26 medals, with 9 gold, 6 silver, and 11 bronze medals. This places India behind several countries in the table, indicating room for improvement in its Olympic performance.

+ Overall, the data underscores the varying levels of success among different countries, with China and Russia emerging as top contenders, while countries like India and Nigeria exhibit potential for growth and development in their Olympic pursuits.


# Analysing the Top Countries Dominating both the Summer and Winter Olympics over the Years: A Time-Series Analysis 

## Analysis of Total Medals Over the Years

+ The plot displays the total number of medals won by the top 5 countries (GER, SWE, URS, USA) over the years.
+ The data spans from the early 1900s to 2010, showing fluctuations in medal counts for each country.
+ The Soviet Union (URS) exhibits a significant peak in medals won around the 1980s, indicating a period of dominance in   the Olympics.
+ The United States (USA) consistently maintains high medal counts throughout the years, with noticeable peaks and  troughs.
+ Germany (GER) shows an upward trend in medal counts post-1950s, while Sweden (SWE) remains relatively stable with lower medal counts compared to other countries.
+The plot highlights the changing dynamics and competitive landscape of the Olympics, with different countries emerging as dominant forces in different time periods.

##Plot 1:

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Top Countries that Dominate in both the Summer and Winter Olympics\\label{Figure1}", fig.ext = 'png', fig.height = 5, fig.width = 7}

# This function is designed to process Olympic medal data, distinguishing between team and individual sports/events, and adjusting medal counts accordingly. The function then aggregates the total medals by country.

all_countries_medals <- filter_process_all_countries(Summer)

top_performers <- find_top_performing_countries(all_countries_medals, top_n = 10)
#USA, URS, GBR, FRA, GER, ITA, SWE, HUN, AUS, CHN

filtered_winter <- filter_process_winter(Winter)

top_performers_winter <- find_top_performing_countries(filtered_winter, top_n = 10)
#Norway, USA, AUT, GER, URS, CAN, FIN, SWE, SUI, RUS 


#The filter_and_combine_olympic_data_dominators function is designed to filter and combine datasets for countries that perform well in both the Summer and Winter Olympics. It also categorizes sports/events as either team or individual sports.

dominating_olympic_data_dominators<- filter_and_combine_olympic_data_dominators(Summer, Winter)

#The create_time_series_plot function is designed to create a time series plot showing the total number of medals won by different countries over the years in both the Summer and Winter Olympics. The plot visualizes the performance of countries over time.

times_series_olympic_dominators <- create_time_series_plot(dominating_olympic_data_dominators)
times_series_olympic_dominators

```
# The Most Unlikely Top Countries as per GDP Per Capita or by Population 

 **Top 5 Countries by Medals Per Capita**:
  
  - **URS (Union of Soviet Socialist Republics)**: Stands out significantly, indicating that the country had a high medal count relative to its population size.
  
  - **GDR (German Democratic Republic)**: Also shows a strong performance, punching above its weight in terms of population size. East Germany, officially known as the German Democratic Republic, was a country in Central Europe from its formation on 7 October 1949 until its reunification with West Germany on 3 October 1990.
  
  - **ROU (Romania)**: Shows a commendable number of medals won per capita.
  
  - **FRG (Federal Republic of Germany)**: Consistently performs well in the Olympic Games, and is referencing West Germany. West Germany[a] is the common English name for the Federal Republic of Germany (FRG)[b] from its formation on 23 May 1949 until the reunification with East Germany on 3 October 1990.
  
  - **TCH (Czechoslovakia)**: Displays strong performance relative to its population.
  
##Plot 2: 


```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Top Countries that Dominate Winning Medals Per Capita\\label{Figure2}", fig.ext = 'png', fig.height = 3, fig.width = 5}

all_countries_df <- filter_and_combine_all_olympic_data(Summer, Winter)

#This metrics_data function is designed to calculate performance metrics for countries based on their Olympic medals, population, and GDP per capita. The metrics calculated include medals per capita and medals per GDP.

metrics_data_combined <- metrics_data(all_countries_df, GDP)

#Find and visualize top countries by Medals_Per_Capita
plot_metals_per_capita <- find_and_visualize_top_countries(metrics_data_combined, "Medals_Per_Capita")
plot_metals_per_capita 

```

**Top 5 Countries by Medals Per GDP**:

 - **URS (Union of Soviet Socialist Republics)**: Again leads, showing exceptional performance relative to its economic size.

 - **GDR (German Democratic Republic)**: Demonstrates effective use of economic resources in achieving Olympic success.

 - **ROU (Romania)**: Efficiently converts its economic resources into medals.
 
  - **FRG (Federal Republic of Germany)**: Maintains a strong position in terms of medals per GDP.

  - **CUB (Cuba)**: Punches above its weight economically in terms of Olympic success.
  
##Plot 3: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Top Countries that Dominate Winning Medals Per Capita\\label{Figure3}", fig.ext = 'png', fig.height = 3, fig.width = 5}

#Find and visualize top countries by Medals_Per_GDP
plot_metals_per_GDP  <- find_and_visualize_top_countries(metrics_data_combined, "Medals_Per_GDP")
plot_metals_per_GDP 
```

**Similarity in Figures**:
+ The two figures show similar countries leading in both medals per capita and medals per GDP. This similarity suggests that these countries not only excel in their ability to convert population size into Olympic success but also manage their economic resources efficiently to achieve high medal counts. 

+ The dominance of URS and GDR in both figures highlights their historical strength in Olympic competitions during the periods they existed, indicating state-sponsored sports programs and a high prioritization of athletic success.

+ Countries like Romania (ROU) and the Federal Republic of Germany (FRG) demonstrate consistent performance, reflecting well-organized sports programs that effectively harness both population and economic resources.

# An Analysis of Archery 

+ Archery’s history at the Olympic Games is split into two periods: the early era and the modern era.

+ The sport featured on the programme of the Olympic Games in 1900, 1904, 1908 and 1920 during the early era. It was also one of the first sports to feature women’s events, in 1904. The competition formats were inconsistent, often based on local rules, and archery was subsequently dropped from the programme. World Archery was founded in 1931 with the goal of rejoining the Games.

+ Archery returned to the Olympic Games in 1972 and has remained on the programme ever since. During this modern era, the competition format has evolved toward exciting, easily accessible and broadcast-friendly head-to-head matchplay. Two gold medals, for the individual events, were awarded from 1972 to 1984; team events were added in 1988.

##Plot 4: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Top Individual Events by Country in Winning Medals in Archery\\label{Figure4}", fig.ext = 'png', fig.height = 5, fig.width = 7}

#The analyze_archery function is designed to analyze the performance of countries in Archery individual events at the Summer Olympics. It processes the data to filter Archery individual events, counts the medals, and visualizes the total medals by country.

archery_plot <- analyze_archery(Summer)

```

## List of Countries in the Figure above 
+ AUS: Australia
+ CHN: China
+ EUN: Unified Team
+ FIN: Finland
+ FRA: France
+ GBR: Great Britain
+ ITA: Italy
+ JPN: Japan
+ KOR: South Korea
+ MEX: Mexico
+ NED: Netherlands
+ POL: Poland
+ RUS: Russia
+ SWE: Sweden
+ UKR: Ukraine
+ URS: Union of Soviet Socialist Republics
+ USA: United States

##Plot 5: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "A Pie Chart showcasing the Distibution of Medal Winnings by the Top 5 Countries in Individual Archery Events\\label{Figure5}", fig.ext = 'png', fig.height = 5, fig.width = 7}

#The plot_medal_distribution_by_country function is designed to visualize the distribution of medals won by the top 5 countries in Archery individual events at the Summer Olympics. It processes the data to filter Archery individual events, counts the medals, and creates a pie chart to display the distribution.

distribution_plot_piechart<- plot_medal_distribution_by_country(Summer)

```

+ The pie chart above shows the medal distribution by the top 5 countries in Archery individual events between the years 1900 and 2012. South Korea (KOR) dominates the chart with 46.7% of the total medals, followed by the USA (20%), the Soviet Union (URS) with 15.6%, Japan (JPN) with 8.9%, and China (CHN) with 8.9%.

## Analysing the Performance in Individual Archery Events by Gender

+ The multi-panel plot compares the performance in Archery individual events by gender within the top 5 countries (China, Finland, Japan, South Korea, Soviet Union, and the USA) from 1970 to 2010. 

+ Each panel represents one of the top countries, showing the total medals won by men and women over the years. 

+South Korea (KOR) and the USA display noticeable differences in performance between genders, while other countries like China, Finland, and Japan show consistent performance between men and women.

##Plot 6: 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Top Countries that Dominate in both the Summer and Winter Olympics\\label{Figure6}", fig.ext = 'png', fig.height = 5, fig.width = 7}

#The analyze_top_countries_gender_performance function is designed to analyze and visualize the performance of the top countries in Archery individual events at the Summer Olympics, broken down by gender. It processes the data to filter Archery individual events, counts the medals, identifies the top countries, and creates a line plot to display the performance over the years. 

top_country_gender_plot<- analyze_top_countries_gender_performance(Summer)

```

##Plot 7:

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Top Countries that Dominate in both the Summer and Winter Olympics\\label{Figure7}", fig.ext = 'png', fig.height = 6, fig.width = 7}

#The analyze_gender_gold_correlation function is designed to analyze the correlation between gender and the likelihood of winning a gold medal in Archery individual events at the Summer Olympics. It filters the data, identifies the top countries, creates a binary outcome variable, fits a logistic regression model, and visualizes the predicted probabilities.

gender_gold_correlation_plot <- analyze_gender_gold_correlation(Summer)

```

+ Finally, \ref{Figure6}, determines if there is a correlation between gender and the probability of winning a medal by  fitted a logistic regression model.

+ This model helped us predict the probability of winning a gold medal based on gender.

+ The x-axis represents the gender (Men and Women).

+ The y-axis represents the predicted probability of winning a gold medal.

+ Each dot represents a predicted probability from the logistic regression model.

+ The predicted probabilities for men are clustered around 0.46, while for women, they are around 0.38.
This indicates that, historically, men have had a higher probability of winning gold medals in Archery individual events compared to women within the top 10 countries.









