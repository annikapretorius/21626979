---
# IMPORTANT: Change settings here, but DO NOT change the spacing.
# Remove comments and add values where applicable.
# The descriptions below should be self-explanatory

title: "Analaysing the Persistence and Patterns of Baby Naming Conventions"
#subtitle: "This will appear as Right Header"

documentclass: "elsarticle"

# --------- Thesis title (Optional - set to FALSE by default).
# You can move the details below around as you please.
Thesis_FP: FALSE
# Entry1: "An unbelievable study with a title spanning multiple lines."
# Entry2: "\\textbf{Nico Katzke}" # textbf for bold
# Entry3: "A thesis submitted toward the degree of Doctor of Philosophy"
# Uni_Logo: Tex/Logo.png # Place a logo in the indicated location (from your root, e.g. defaults to ~/Tex/Logo.png) and uncomment this line. Leave uncommented for no image
# Logo_width: 0.3 # If using a logo - use this to set width (size) of image
# Entry4: "Under the supervision of: \\vfill Prof. Joe Smith and Dr. Frank Smith"
# Entry5: "Stellenbosch University"
# Entry6: April 2020
# Entry7:
# Entry8:

# --------- Front Page
# Comment: ----- Follow this pattern for up to 5 authors
AddTitle: TRUE # Use FALSE when submitting to peer reviewed platform. This will remove author names.
Author1: "Annika Pretorius"  # First Author - note the thanks message displayed as an italic footnote of first page.
Ref1: "Stellenbosch University" # First Author's Affiliation


CorrespAuthor_1: FALSE  # If corresponding author is author 3, e.g., use CorrespAuthor_3: TRUE

# Comment out below to remove both. JEL Codes only given if keywords also given.
# keywords: "Multivariate GARCH \\sep Kalman Filter \\sep Copula" # Use \\sep to separate
# JELCodes: "L250 \\sep L100"

# ----- Manage headers and footers:
#BottomLFooter: $Title$
#BottomCFooter:
#TopLHeader: \leftmark # Adds section name at topleft. Remove comment to add it.
BottomRFooter: "\\footnotesize Page \\thepage" # Add a '#' before this line to remove footer.
addtoprule: TRUE
addfootrule: TRUE               # Use if footers added. Add '#' to remove line.

# --------- page margins:
margin: 2.3 # Sides
bottom: 2 # bottom
top: 2.5 # Top
HardSet_layout: TRUE # Hard-set the spacing of words in your document. This will stop LaTeX squashing text to fit on pages, e.g.
# This is done by hard-setting the spacing dimensions. Set to FALSE if you want LaTeX to optimize this for your paper.

# --------- Line numbers
linenumbers: FALSE # Used when submitting to journal

# ---------- References settings:
# You can download cls format here: https://www.zotero.org/ - simply search for your institution. You can also edit and save cls formats here: https://editor.citationstyles.org/about/
# Hit download, store it in Tex/ folder, and change reference below - easy.
bibliography: Tex/ref.bib       # Do not edit: Keep this naming convention and location.
csl: Tex/harvard-stellenbosch-university.csl # referencing format used.
# By default, the bibliography only displays the cited references. If you want to change this, you can comment out one of the following:
#nocite: '@*' # Add all items in bibliography, whether cited or not
# nocite: |  # add specific references that aren't cited
#  @grinold2000
#  @Someoneelse2010

# ---------- General:
RemovePreprintSubmittedTo: TRUE  # Removes the 'preprint submitted to...' at bottom of titlepage
Journal: "Journal of Finance"   # Journal that the paper will be submitting to, if RemovePreprintSubmittedTo is set to TRUE.
toc: FALSE                       # Add a table of contents
numbersections: TRUE             # Should sections (and thus figures and tables) be numbered?
fontsize: 11pt                  # Set fontsize
linestretch: 1.2                # Set distance between lines.
link-citations: TRUE            # This creates dynamic links to the papers in reference list.

### Adding additional latex packages:
# header-includes:
#    - \usepackage{colortbl} # Add additional packages here.

output:
  pdf_document:
    keep_tex: TRUE
    template: Tex/TexDefault.txt
    fig_width: 3.5 # Adjust default figure sizes. This can also be done in the chunks of the text.
    fig_height: 3.5
abstract: |
  In this study, we analyze historical baby naming trends in the US from 1910 to 2014, focusing on the influence of cultural factors such as the media and celebrities. Our findings provide insights into the persistence of popular names and the impact of societal trends on naming conventions, aiding a toy design agency in selecting resonant character names for their products.
---


```{r setup, include= FALSE}

library(tidyverse)
library(stringr)
library(dplyr)
library(ggplot2)

list.files('code/', full.names = T, recursive = T) %>% .[grepl('.R', .)] %>% as.list() %>% walk(~source(.))

source("code/filter_and_arrange_baby_names.R")
source("code/prepare_HBO_data.R")
source("code/combine_top_25_names.R")
source("code/plot_total_baby_names_per_year_by_gender.R")
source("code/plot_top_25_name_proportions.R")
source("code/plot_name_persistence_heatmap.R")
source("code/calculate_correlation.R")
source("code/plot_correlation.R")
source("code/plot_HBO_name_persistence_summary.R")
source("code/plot_name_persistence_summary.R")
source("code/add.prop.R")
source("code/rank_and_filter_top_25.R")
source("code/plot_HBO_name_persistence.R")

#Loading the Data 

Baby_Names <- readRDS("data/US_Baby_names/Baby_Names_By_US_State.rds")
charts <- readRDS("Data/US_Baby_names/charts.rds")
HBO_Titles <- readRDS("Data/US_Baby_names/HBO_titles.rds")
HBO_Credits <- readRDS("Data/US_Baby_names/HBO_credits.rds")

#Creating Different Datasets for Later Use
Baby_Names_df<- filter_and_arrange_baby_names(Baby_Names)
HBO_joined_df <- prepare_HBO_data(HBO_Titles, HBO_Credits)
combined_result_final_top_25_names <- combine_top_25_names(Baby_Names_df, HBO_joined_df, "Count", "tmdb_popularity")

Girl_Baby_Names_df <- Baby_Names_df %>% filter(Gender == "F")
Boy_Baby_Names_df <- Baby_Names_df %>% filter(Gender == "M")

```

\newpage

# Analaysing the Persistence and Patterns of Baby Naming Conventions 

The naming trends of children have long been a subject of fascination and study. Recently, a New York-based kids' toy design agency has expressed interest in leveraging data analytics to understand these trends better. The primary goal is to identify the factors that influence baby names, such as popular movie characters, US presidential candidates, celebrities, and top-ranking songs or artists. By comprehending these patterns, the agency aims to predict which character names might resonate best with children, thereby enhancing the appeal of their toys.

To facilitate this analysis, we have been provided with an extensive dataset of baby names in the US, spanning from 1910 to 2014. This dataset includes annual data for all US states, offering a comprehensive view of naming patterns over more than a century. Additionally, we have access to population data by state and city, which will help us generate proportional insights at the state level. To supplement our primary dataset, we have also compiled data on music, movies, and TV series, including the Top 100 Billboard songs since 1958 and HBO movie and series titles with their audience popularity scores.

One of the key aspects of our analysis involves examining the longevity and persistence of baby names. Specifically, we aim to determine whether popular names tend to persist over time or if they fade away as fleeting trends. A useful method for this investigation is the Spearman rank correlation, which will help us assess the rank similarity of the top 25 most popular boys' and girls' names from one year to the next three years. This will provide insights into whether the trends of popular names have become more or less persistent over the decades, particularly since the 1990s.

Figure \ref{Figure1} below shows the total count of baby names per year by gender. The blue line represents male names, while the red line represents female names. This visualization highlights the fluctuations in the popularity of baby names over time, offering a foundation for our deeper analysis of naming trends. 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "Total Count of Baby Names by Gender.\\label{Figure1}", fig.ext = 'png', fig.height = 3, fig.width = 5}

total_baby_names_plot <- plot_total_baby_names_per_year_by_gender(Girl_Baby_Names_df, Boy_Baby_Names_df)
print(total_baby_names_plot )

```
Figure \ref{Figure2} below illustrates the proportion of the top 25 baby names over time for both female and male names.The horizontal axis represents the years from 1950 to 2014. The vertical axis represents the proportion of babies given a specific name each year. This is calculated as the count of babies with that name divided by the total count of babies for that year.Each line represents a specific name that was in the top 25 for that year. The color of each line corresponds to a different name. The plot is divided into two facets: one for female names and one for male names. This separation helps to compare the trends for female and male names independently.

+ Female Names: The left facet shows the proportion trends for the top 25 female names over time. The plot indicates that the popularity of the top names was relatively higher in the past (1950s to 1980s) and has become more evenly distributed in recent years.

+ Male Names: The right facet shows the proportion trends for the top 25 male names over time. Similar to female names, the plot indicates that the popularity of the top names was higher in the past and has become more evenly distributed in recent years. 

The peaks in the plot indicate years when specific names were particularly popular. The valleys indicate years when the popularity of those names decreased. Declining Trends: For both female and male names, the plot shows a general declining trend in the proportion values, indicating that the popularity of top names has become less concentrated over time. This suggests a diversification in naming trends, with a wider variety of names being used in recent years.

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Proportion of the Top 25 Baby Names and their Persistence Over Time\\label{Figure2}", fig.ext = 'png', fig.height = 4, fig.width = 6}
#The vertical axis represents the proportion of babies given a specific name each year. This is calculated as the count of babies with that name divided by the total count of babies for that year.

top_name_proportions_plot<- plot_top_25_name_proportions(Girl_Baby_Names_df, Boy_Baby_Names_df)
top_name_proportions_plot
```


# Analysing the Persistence of Names over Time: A Time Series Analysis

Figure \ref{Figure3} below showcases the persistence of the most popular baby names from a given dataset. The color gradient from white to blue represents the presence of a name in the top 25 baby names for each year, with darker shades of blue indicating higher persistence. Notable names such as "Jessica," "Jennifer," and "Emily" show strong persistence over the years, particularly in the 1980s and 1990s.
Names like "Susan" and "Mary" were more popular in earlier decades, while "Ashley" and "Amanda" gained popularity later on.Names like "Robert," "Michael," and "John" demonstrate strong persistence, especially from the 1960s to the 2000s.
Other names such as "Matthew," "Joshua," and "Joseph" show high presence in the top 25 names in the 1980s and 1990s.
Male names show more consistent presence over a longer period compared to female names, which exhibit more variation and changes over the years.

```{r,  echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', fig.cap = "The Proportion of the Top 25 Baby Names and their Persistence Over Time for both Genders\\label{Figure3}", fig.ext = 'png', fig.height = 4, fig.width = 6}

plot_baby_name_persistance<- plot_name_persistence_heatmap(Girl_Baby_Names_df, Boy_Baby_Names_df)
plot_baby_name_persistance

```

# Analyzing how long each name stayed in top 25 

```{r,  echo = FALSE, warning =  FALSE, fig.align = 'center', fig.cap = "The Number of Years the Top 25 Baby Names Persisted Over Time for both Genders\\label{Figure4}", fig.ext = 'png', fig.height = 4, fig.width = 6}

summary_name_persistance_plot<- plot_name_persistence_summary(Girl_Baby_Names_df, Boy_Baby_Names_df)
summary_name_persistance_plot

```

We can therefore see that the top boy names over the last few decades illustrate significant persistence in comparison to that of girl names, therefore, we will further analyse factors influencing girl names as they display significantly higher variability which could be linked to alternate factors.  

# Analysing the HBO Dataset

```{r,  echo = FALSE, warning = FALSE, message = FALSE,  fig.align = 'center', fig.cap = "The Persistence of HBO names in the top rankings over time\\label{Figure5}", fig.ext = 'png', fig.height = 4, fig.width = 6}

HBO_name_persistence_plot <- plot_HBO_name_persistence(combined_result_final_top_25_names)
HBO_name_persistence_plot

```
We can see the above persistence is all male names within data regarding movies on HBO over the last few decades. 

# The Persistence of HBO names in the Top Rankings over Time.

In the Figure \ref{Figure6} below, the name "John" stands out as the most persistent name, having stayed in the top rankings for 40 years. This indicates that "John" was a popular name in HBO shows over a prolonged period. Names like "Robert," "Michael," "David," and "Richard" also exhibit high persistence, each maintaining their presence in the top rankings for over 20 years.The presence of these names over many years suggests a trend in character naming conventions in HBO shows. The recurrence of these names might reflect cultural preferences or character archetypes frequently used in HBO's storytelling.

The distribution of the years in top rankings shows that while some names had a very long presence, there is a gradual decline as we move down the list. Names like "Tom," "Peter," and "Jack," though still significant, have a lesser persistence compared to the top names.

The bar chart effectively highlights the relative persistence of each name, with the length of the bars corresponding to the number of years each name stayed in the top rankings. The use of horizontal bars makes it easy to compare the persistence across different names. This analysis helps in understanding the longevity and popularity of certain names within HBO shows, providing insights into naming trends and cultural influences over the years.

```{r,  echo = FALSE, warning = FALSE, message = FALSE, fig.align = 'center', fig.cap = "The Persistence of HBO names in the top rankings over time.\\label{Figure6}", fig.ext = 'png', fig.height = 4, fig.width = 6}

# Plot the persistence of HBO names
summary_HBO_persistance_plot<- plot_HBO_name_persistence_summary(combined_result_final_top_25_names)
summary_HBO_persistance_plot

```

Now i will analyse the correlation between the persistent boy names within the Baby names dataframe in comparison to that of the most persistent names within the HBO baby frame, which all happen to be male. 

```{r,  echo = FALSE, warning = FALSE, message = FALSE,  fig.align = 'center', fig.cap = "The Correlation Between the Persistence of HBO names and Baby Names.\\label{Figure7}", fig.ext = 'png', fig.height = 4, fig.width = 6}

result <- calculate_correlation(combined_result_final_top_25_names)
combined_persistence <- result$combined_persistence
correlation_value <- result$correlation_value
correlation_plot <- plot_correlation(combined_persistence, correlation_value)

print(correlation_plot)
print(paste("Spearman correlation value: ", round(correlation_value, 2)))

```

In Figure \ref{Figure7} above the correlation between the persistence of baby names in the top 25 rankings and HBO names in the top 25 rankings over time are analysed. Each point on the scatter plot represents a name that appears in each of the datasets. The x-axis shows the number of years a name remained in the top 25 baby names, while the y-axis indicates the number of years the same name stayed in the top 25 HBO rankings.

A positive Spearman correlation value of `r round(correlation_value, 3)`. was calculated, which indicates a moderate positive correlation between the persistence of baby names and HBO names. This suggests that names that tend to be popular for longer periods as baby names are also likely to remain popular in HBO rankings for a significant duration. The blue line represents a linear fit, illustrating the trend of this correlation. While there is some spread in the data, with a number of outliers, the general trend suggests that there is a relationship between the duration of name popularity in both contexts.




